# RESTler True Positives

RESTler is a stateful REST API fuzzing tool. Most "vulnerabilities" are intentional features.

**Likelihood of Real Issues: MEDIUM** — `shell=True` subprocess calls with user-controlled paths

---

## 1. ⚠️ COMMAND_INJECTION via `shell=True` in build script — **TRUE POSITIVE**

**Severity**: MEDIUM-HIGH  
**Exploitability**: MEDIUM (build-time, path-controlled)

```python
# build-restler.py:127
subprocess.run(f'"{dirs.python_path}" -m compileall -q "{dirs.engine_build_dir}"', 
               shell=True, capture_output=True, check=True)

# build-restler.py:173
subprocess.run(restore_args, shell=True, stderr=subprocess.PIPE, check=True)

# build-restler.py:182
subprocess.run(f"dotnet publish \"{proj_file_path}\" --no-restore ...", 
               shell=True, stderr=subprocess.PIPE, check=True)
```

**Why this is a concern:**
- `dirs.python_path` and `dirs.engine_build_dir` are derived from paths
- If paths contain shell metacharacters (`;`, `|`, `$(...)`), command injection possible
- Build scripts often run with elevated privileges

**Attack scenario:**
```bash
# Create malicious directory name
mkdir -p '/tmp/restler; touch /tmp/pwned;/'
# Build RESTler with that path
python build-restler.py --python-path "/tmp/restler; touch /tmp/pwned;/python"
```

**Effective Likelihood: 40%** — Requires path manipulation

---

## 2. ⚠️ COMMAND_INJECTION in quick-start script — **TRUE POSITIVE**

**Severity**: MEDIUM  
**Exploitability**: MEDIUM

```python
# restler-quick-start.py:55, 77, 124
subprocess.run(command, shell=True)  # Multiple locations
```

**Why this is a concern:**
- `shell=True` with user-controlled paths from CLI arguments
- Quick-start is entry point for new users

**Effective Likelihood: 40%**

---

## 3. Token refresh command execution — **INTENTIONAL FEATURE (demoted)**

**Severity**: N/A (intentional)  
**Exploitability**: N/A

```python
# restler/engine/core/request_utilities.py:172-174
cmd_result = subprocess.getoutput([cmd])
```

**Why this is NOT a vulnerability:**
- Users explicitly provide their own token refresh command
- Documented feature for authentication
- Security testing tool designed to run user commands

**Effective Likelihood: N/A** — Intentional feature

---

## 4. REGEX_INJECTION in preprocessing — **Self-DoS only**

**Severity**: LOW  
**Exploitability**: VERY LOW

```python
# restler/engine/core/preprocessing.py:60
include_req = re.findall(path_regex, request.endpoint_no_dynamic_objects)
```

**Why this is demoted:**
- `path_regex` comes from CLI args (user controls their own input)
- Local tool — user providing bad regex only harms themselves
- No multi-user attack scenario

**Effective Likelihood: <1%**

---

## 5. BOUNDS in primitives.py — Internal API crash

**Severity**: LOW  
**Crashability**: LOW

```python
# restler/engine/primitives.py:520
field_name = args[0]  # IndexError if no args
```

**Why this is low priority:**
- Internal grammar parsing API
- Grammar generated by RESTler compiler, not user input
- Requires manually crafted malformed grammar

**Effective Likelihood: 5%**

---

**Summary:** RESTler's main issues are:
1. **`shell=True` subprocess calls in build scripts** — Should use subprocess list form
2. **`shell=True` in quick-start** — Same issue

Token command execution and regex patterns are intentional features, not bugs.

**Effective True Positives: 2-3 (shell=True issues)**
